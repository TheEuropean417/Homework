<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Homework ‚Äî The European</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">Homework</div>
    <div class="actions"><button id="adminBtn" class="btn ghost">Admin</button></div>
  </header>

  <main class="container">
    <!-- Futuristic status bar (click any tile to toggle its filter) -->
    <div class="statusbar">
      <div class="statrow">
        <div class="stat late toggle" data-key="Late"><span class="label">Late</span><span id="kLate" class="count">0</span></div>
        <div class="stat today toggle" data-key="Today"><span class="label">Today</span><span id="kToday" class="count">0</span></div>
        <div class="stat tom toggle" data-key="Tomorrow"><span class="label">Tomorrow</span><span id="kTom" class="count">0</span></div>
        <div class="stat up toggle" data-key="Upcoming"><span class="label">Upcoming</span><span id="kUp" class="count">0</span></div>
        <div class="stat sub toggle" data-key="Submitted"><span class="label">Submitted</span><span id="kSub" class="count">0</span></div>
        <div class="stat ret toggle" data-key="Returned"><span class="label">Returned</span><span id="kRet" class="count">0</span></div>
      </div>
    </div>

    <div class="controls">
      <div class="row">
        <input id="searchInput" class="input" placeholder="Search (title, class, notes, status)‚Ä¶" />
        <button id="syncBtn" class="btn primary">Sync Classroom</button>
      </div>
      <div class="chips">
        <label class="chip"><input id="fLate"      type="checkbox" checked> <span>Late</span></label>
        <label class="chip"><input id="fToday"     type="checkbox" checked> <span>Due Today</span></label>
        <label class="chip"><input id="fTomorrow"  type="checkbox" checked> <span>Due Tomorrow</span></label>
        <label class="chip"><input id="fUpcoming"  type="checkbox" checked> <span>Upcoming</span></label>
        <label class="chip"><input id="fBypassed"  type="checkbox">         <span>Bypassed</span></label>
        <label class="chip"><input id="fSubmitted" type="checkbox">         <span>Submitted</span></label>
        <label class="chip"><input id="fReturned"  type="checkbox">         <span>Returned</span></label>
      </div>
    </div>

    <div id="loading" class="loading hidden">Loading‚Ä¶</div>
    <div id="empty" class="empty hidden">No homework found.</div>
    <section id="cards" class="cards"></section>
  </main>

  <!-- Admin Control Center -->
  <dialog id="adminModal" class="modal">
    <form method="dialog" class="modal-card" id="adminForm">
      <div class="modal-head">
        <h3 id="accTitle">Admin Control Center</h3>
        <button type="button" id="adminClose" class="icon-btn" aria-label="Close">‚úï</button>
      </div>

      <!-- Professional ‚Äúlock screen‚Äù style gate -->
      <div id="adminGate" class="gate">
        <div class="auth-box">
          <div class="auth-title">Administrator Access</div>
          <div class="auth-sub">Enter your admin password to manage recipients, templates, and notifications.</div>
          <div class="input-wrap">
            <input id="adminPassword" class="input auth-input" type="password" placeholder="Admin password" aria-labelledby="accTitle">
            <button type="button" class="eyebtn" id="adminPwToggle" aria-label="Show password" data-toggle="password">üëÅ</button>
          </div>
          <div id="adminErr" class="error hidden"></div>
          <div class="row end"><button id="adminUnlock" type="button" class="btn primary">Unlock</button></div>
        </div>
      </div>

      <div id="adminBody" class="admin hidden">
        <section class="panel">
          <h4>Recipients</h4>
          <div id="recipientsList" class="list"></div>
          <div class="row gap">
            <input id="recName"   class="input" placeholder="Name">
            <input id="recEmail"  class="input" placeholder="Email (for email channel)">
            <input id="recChatId" class="input" placeholder="Telegram chat_id (optional)">
            <button id="addRecipient" type="button" class="btn">Add</button>
          </div>
        </section>

        <section class="panel">
          <h4>Templates</h4>
          <div id="templatesList" class="list"></div>
          <div class="col gap">
            <input id="tmplName" class="input" placeholder="Template key (e.g., due_soon)">
            <textarea id="tmplBody" class="textarea" rows="3" placeholder="Body. Vars: {title} {course} {dueDate} {dueIn} {status}"></textarea>
            <button id="addTemplate" type="button" class="btn">Save Template</button>
          </div>
        </section>

        <section class="panel">
          <h4>Notification Rules</h4>
          <div class="grid-2">
            <label class="field"><span>Quiet Hours (HH:MM‚ÄìHH:MM)</span><input id="quiet" class="input" placeholder="21:00-07:00"></label>
            <label class="field"><span>Due Soon (hours before due)</span><input id="dueSoonHrs" class="input" type="number" min="0" value="24"></label>
            <label class="field"><span>Notify when becomes Late</span><input id="onLate" type="checkbox"></label>
            <label class="field"><span>Daily Summary Time</span><input id="summaryTime" class="input" placeholder="19:30"></label>
            <label class="field"><span>Template Key</span><input id="alertTemplate" class="input" placeholder="due_soon"></label>
          </div>
        </section>

        <section class="panel">
          <h4>Channels</h4>
          <div class="grid-2">
            <label class="field"><span>Telegram Enabled</span><input id="tgEnable" type="checkbox"></label>
            <label class="field"><span>Telegram Bot Token</span><input id="tgToken" class="input" placeholder="123456:ABC-DEF..."></label>
            <label class="field"><span>Telegram chat_ids (CSV)</span><input id="tgChatIds" class="input" placeholder="6406811650, -1001234567890"></label>
            <label class="field"><span>Email Enabled</span><input id="emailEnable" type="checkbox"></label>
            <label class="field"><span>Email Subject</span><input id="emailSubject" class="input" placeholder="Homework Reminder"></label>
          </div>

          <div class="panel">
            <h4>Send Test Email</h4>
            <div class="grid-2">
                <textarea id="emailTestBody" class="textarea" rows="3" placeholder="Test email body‚Ä¶">Test: Homework email notifications are configured and working.</textarea>
                <div class="col gap">
                <input id="emailTestSubject" class="input" placeholder="Subject (optional)" value="Homework ‚Äî Test Notification">
                <button id="sendTestEmail" class="btn primary">Send Test Email to All</button>
                <div id="sendTestEmailStatus" class="small muted"></div>
                </div>
            </div>
            </div>


          <div class="col gap" style="margin-top:8px">
            <textarea id="testMsg" class="textarea" rows="2" placeholder="Test message">Test: Notifications are working ‚úÖ</textarea>
            <div class="row">
              <button id="testTelegramBtn" type="button" class="btn">Send Test Telegram</button>
              <button id="testEmailBtn" type="button" class="btn">Send Test Email</button>
            </div>
          </div>
        </section>

          <div class="col gap" style="margin-top:8px">
            <textarea id="testMsg" class="textarea" rows="2" placeholder="Test message">...</textarea>
            <div class="row">
                <button id="testTelegramBtn" type="button" class="btn">Send Test Telegram</button>
                <button id="testEmailBtn" type="button" class="btn">Send Test Email</button>
            </div>
            </div>
            </section>

<!-- Bypass Manager -->
<section class="panel">


        <!-- Bypass Manager -->
        <section class="panel">
          <h4>Bypass Manager</h4>
          <div class="small muted">Bypassed items are hidden unless the ‚ÄúBypassed‚Äù filter is enabled.</div>
          <div class="row gap">
            <button id="refreshBypass" class="btn">Refresh</button>
            <button id="unbypassAll" class="btn">Un-bypass All</button>
          </div>
          <div id="bypassList" class="list"></div>
        </section>

        <div class="row end"><button type="button" id="saveAdmin" class="btn primary">Save</button></div>
      </div>
    </form>
  </dialog>

  <!-- Reusable professional password confirmation modal -->
  <dialog id="pwConfirmModal" class="modal">
    <form method="dialog" class="modal-card small" id="pwConfirmForm">
      <div class="modal-head">
        <h3 id="pwTitle">Admin Confirmation</h3>
        <button type="button" id="pwClose" class="icon-btn" aria-label="Close">‚úï</button>
      </div>
      <div class="auth-box">
        <div class="auth-sub" id="pwReason">This action requires administrator authorization.</div>
        <div class="input-wrap">
          <input id="pwConfirmInput" class="input auth-input" type="password" placeholder="Enter admin password">
          <button type="button" class="eyebtn" id="pwToggle" aria-label="Show password">üëÅ</button>
        </div>
        <div id="pwErr" class="error hidden"></div>
        <div class="row end">
          <button value="cancel" class="btn">Cancel</button>
          <button id="pwConfirmBtn" type="button" class="btn primary">Confirm</button>
        </div>
      </div>
    </form>
  </dialog>

  <script type="module" src="assets/js/config.js"></script>
  <script type="module" src="assets/js/state.js"></script>
  <script type="module" src="assets/js/notify.js"></script>
  <script type="module" src="assets/js/classroom.js"></script>
  <script type="module" src="assets/js/ui.js"></script>
</body>
</html>
